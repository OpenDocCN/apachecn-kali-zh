# 建立评估环境

在上一章中，我们学习了如何从治理角度理解漏洞管理计划的要点。本章将介绍建立全面漏洞评估和渗透测试环境的各种方法和技术。我们将学习如何建立我们自己的环境，可以有效地用于本书后面讨论的各种脆弱性评估技术。

本章将介绍以下主题：

*   设置 Kali 虚拟机
*   Kali Linux 基础知识
*   环境配置和设置
*   评估期间使用的工具清单

# 设置 Kali 虚拟机

执行漏洞评估或渗透测试涉及一系列需要借助多种工具和实用程序执行的任务。对于流程中涉及的每个任务，都有可用的工具，既有商业工具，也有免费软件和开源工具。这完全取决于我们根据上下文选择最适合的工具。

为了执行端到端评估，我们可以在需要时下载单个工具，也可以使用预装所有必需工具的发行版，如 Kali Linux。Kali Linux 是一个稳定、灵活、功能强大且经验证的渗透测试平台。它具有贯穿渗透测试所有阶段执行各种任务所需的工具基线。它还允许您轻松添加不属于默认安装的工具和实用程序。

因此，Kali Linux 确实是开始进行漏洞评估和渗透测试的良好平台选择。

Kali Linux 可在[下载 https://www.kali.org/downloads/](https://www.kali.org/downloads/) 。

下载后，您可以直接在系统上安装，也可以在虚拟机上安装。在虚拟机中安装它的好处是它可以保持现有操作系统设置不受干扰。此外，使用快照进行配置备份并在需要时进行恢复变得非常容易。

虽然 Kali Linux 可以以 ISO 文件的形式下载，但它也可以作为完整的虚拟机下载。您可以根据所使用的虚拟化软件（VMware/VirtualBox/Hyper-V）下载正确的设置。Kali 虚拟机设置文件可在[下载 https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-hyperv-image-download/](https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-hyperv-image-download/) 。

下面的屏幕截图显示了 VMware 中的 Kali Linux。您可以通过选择编辑虚拟机设置选项、分配内存和选择网络适配器类型来配置计算机设置。完成后，您可以简单地玩机器：

![](assets/64e304c2-9e12-4b8b-aa28-264de2b89098.png)

# Kali Linux 基础知识

访问 Kali Linux 的默认凭据为`username:root`和`password:toor`。但是，在第一次登录后，更改默认凭据并设置新密码很重要。可以使用`passwd `命令设置新密码，如以下屏幕截图所示：

![](assets/527cd47b-954d-4b41-aef9-cf8323433d04.png)

Kali Linux 广泛用于网络和应用程序渗透测试。因此，将 Kali Linux 连接到网络非常重要，因为独立的 Kali 安装没有多大用处。确保网络连接的第一步是检查 Kali 是否具有有效的 IP 地址。我们可以使用如下截图所示的`ifconfig`命令，确认 IP 地址分配：

![](assets/ee55f814-5e42-44fd-bff3-db6eb438e3d4.png)

现在我们已经更改了默认凭据并确认了网络连接，现在是时候检查我们的 Kali 安装的确切版本了。这包括确切的构建细节，包括内核和平台细节。`uname -a`命令提供了所需的详细信息，如以下屏幕截图所示：

![](assets/e1078121-e771-466d-9005-77ca53262cff.png)

Kali Linux 是一个完整的渗透测试发行版，其工具可协助渗透测试生命周期的所有阶段。单击应用程序菜单后，我们可以看到分布在不同类别中的所有可用工具，如以下屏幕截图所示：

![](assets/22af6113-f6e3-4bbb-b299-a71814b6ad75.png)

Kali Linux 附带了大量有用的工具和实用程序。有时，我们需要更改这些工具和实用程序的配置文件。所有工具和实用程序都位于`/usr/bin`文件夹中，如以下屏幕截图所示：

![](assets/b4192ad5-67cf-4312-ae49-a0cc430a6f71.png)

Kali Linux 使用多个在线存储库来提供软件安装和更新。但是，必须定期更新这些存储库源。这可以使用如下屏幕截图所示的`apt-get update`命令来实现：

![](assets/1722c652-25e3-4dd2-ac7a-23585d693000.png)

Kali Linux 还定期获得主要的构建更新。为了升级到最新的可用版本，`apt-get upgrade`命令可以使用，如下屏幕截图所示：

![](assets/193e4130-406c-4f97-8084-748c255bde15.png)

Kali Linux 生成并存储各种类型的日志，如应用程序、系统、安全性和硬件。这些日志对于调试和跟踪事件非常有用。打开位于应用程序|常用应用程序|实用程序|日志的日志应用程序可以查看日志，结果显示在以下屏幕截图中：

![](assets/3d0752f1-32d4-4ff9-9849-d0301649747a.png)

# 环境配置和设置

虽然我们的基本 Kali 安装程序已经启动并运行，但我们还需要安装和配置一些在评估期间可能需要的附加服务。在接下来的部分中，我们将讨论 Kali Linux 中的一些此类有用的服务。

# 网络服务器

在开发阶段，web 服务器将对我们有所帮助，我们可能需要托管一个后门可执行文件。Apache web 服务器默认安装在 Kali Linux 中。我们可以使用`service apache2 start`命令启动 Apache web 服务器，如下面的屏幕截图所示。

我们可以通过`netstat -an | grep ::80`命令验证服务是否成功启动：

![](assets/a8ae05f5-dcbd-4e55-a360-58de9cc26657.png)

现在 Apache 服务器已经启动并运行，我们也可以通过浏览器进行验证。通过点击 localhost（`127.0.0.1`，我们可以看到默认的 Apache 网页，如以下屏幕截图所示：

![](assets/6182d0b1-b2ec-4fb9-9ce5-7543cde36a3e.png)

如果我们想要更改默认页面或希望托管任何文件，我们可以将所需文件放置在`/var/www/html`目录中，如以下屏幕截图所示：

![](assets/55ba3447-79c1-4be9-80d2-bea1bbc2fea5.png)

# 安全 Shell（SSH）

当需要远程安全通信时，SSH 确实是默认的协议选择

在 Kali Linux 中，我们可以通过首先安装 SSH 包来开始使用 SSH。我们可以使用`apt-get install ssh`命令，如下截图所示：

![](assets/de95ca75-abd8-4aec-a7da-d9f23ebdab36.png)

为了确保重启后 SSH 自动启动，我们可以使用`systemctl`命令，如下图所示，并且可以使用`service ssh start`命令启动 SSH 服务：

![](assets/a0828a0d-f41a-4fe3-8206-f9514960a9e8.png)

# 文件传输协议（FTP）

web 服务器可用于快速托管和服务小文件，而 FTP 服务器为托管和服务较大文件提供了更好、可靠的解决方案。我们可以使用`apt-get install vsftpd`命令在 Kali Linux 上安装 FTP 服务器，如以下屏幕截图所示：

![](assets/d65fc672-11a9-4bd3-927a-9c105f183b8f.png)

一旦安装，我们可以根据需要修改`/etc/vsftpd.conf`文件来编辑配置。完成必要的配置后，我们可以使用`service vsftpd start`命令启动 FTP 服务器，如以下屏幕截图所示：

![](assets/78edd188-5d83-4da6-b88c-1fdeb087a649.png)

# 软件管理

命令行实用程序`apt-get`可用于安装大多数所需的应用程序和实用程序。然而，Kali Linux 也有一个用于管理软件的 GUI 工具。可以使用以下路径访问该工具：应用程序|常用应用程序|系统工具|软件。

软件管理器可用于删除现有软件或添加新软件，如以下屏幕截图所示：

![](assets/dcf6fa8a-b9c4-4431-9381-28830a3461c5.png)

# 评估期间使用的工具清单

在渗透测试生命周期中，有大量的工具可用于执行各种任务。但是，以下是渗透测试期间最常用的工具列表：

| **序号** | **渗透测试阶段** | **工具** |
| 1. | 信息收集 | 斯巴达，NMAP，德米特里，肖丹，马尔蒂戈，收割机，侦察机 |
| 2. | 列举 | NMAP，Unicornscan |
| 3. | 脆弱性评估 | OpenVAS、NExpose、Nessus |
| 4. | 获取访问权限 | Metasploit，后门工厂，开膛手约翰，海德拉 |
| 5. | 特权升级 | 变质岩 |
| 6. | 覆盖轨道 | 变质岩 |
| 7. | Web 应用程序安全测试 | Nikto、w3af、Burp 套件、ZAP 代理、SQLmap |
| 8. | 报告 | 请注意，德拉迪斯 |

# 总结

在本章中，我们了解到虚拟环境中的 Kali Linux 可以有效地用于执行漏洞评估和渗透测试。我们还介绍了一些关于 Kali Linux 的绝对基础知识，并配置了它的环境。