# 社会工程

社会工程是通过利用人类弱点来学习和获取有价值信息的实践。这是一种欺骗艺术，当缺乏可利用的目标信息时，对于渗透测试人员来说至关重要。由于人员是任何组织安全防御中最薄弱的环节，因此这是安全基础设施中最脆弱的一层。我们是社会生物，因此我们的天性使我们容易受到社会工程的攻击。社会工程师利用这些攻击获取机密信息或进入受限区域。社会工程采用不同形式的攻击载体；每一个都受到个人想象力的限制，这取决于其执行的影响和方向。本章将讨论专业社会工程师操纵人类泄露信息或实施行为所采用的核心原则和实践。

在本章中，我们将介绍以下主题：

*   制定社会工程师目标和愿景的基本心理学原则
*   社会工程的一般攻击过程和方法以及真实世界的示例

从安全的角度来看，社会工程是操纵人们以实现预期目标的强大武器。在许多组织中，可以对这种做法进行评估，以确保员工的安全完整性，并调查流程和人为弱点。请注意，社会工程的实践非常普遍，并被一系列个人所采用，包括渗透测试人员、诈骗艺术家、身份窃贼、商业伙伴、招聘人员、销售人员、信息经纪人、电话销售人员、政府间谍、不满的员工，甚至儿童。这些不同个体之间的区别因素是社会工程师对目标实施策略的动机。

# 技术要求

在本章中，您需要在系统上安装最新版本的 Kali Linux。

# 模拟人类心理

人类的心理能力依赖于提供输入的感官。这些被用来形成对现实的感知。这种自然现象将人类的感官分为视觉、听觉、味觉、触觉、嗅觉、平衡和加速度、温度、动觉、疼痛和方向。这些感官的运用有效地发展和维持了我们感知世界的方法。

从社会工程的角度来看，通过主要感官（视觉或听觉）、眼动（眼神接触、言语差异、眨眼频率或眼神线索）、面部表情（惊讶、快乐、恐惧、悲伤、愤怒或厌恶）以及观察到或感觉到的其他抽象实体从目标检索或提取的任何信息，可能会增加成功的可能性。通常，社会工程师有必要直接与目标沟通，以获取机密信息或进入禁区。这种通信可以通过物理方式进行，也可以使用电子辅助技术进行。

在现实世界中，两种常用的策略被用来完成这项任务：面谈和审问。然而，在实践中，每种策略都包含其他因素，如环境、目标知识和控制沟通框架的能力。这些综合因素（沟通、环境、知识和框架控制）构成了有效社会工程师实施社会工程攻击的基本技能集。整个社会工程活动依赖于信任关系。如果你不能与目标建立牢固的信任关系，你的努力很可能会失败。

现代社会工程几乎已成为一门科学。请务必访问社会工程框架创建者的网站[http://www.social-engineer.org/](http://www.social-engineer.org/) 。克里斯托弗·哈纳吉（Christopher Hadnagy）经营着该网站，并出版了有关社会工程的材料。他在向公众提供这些信息方面做得非常出色，因此我们可以尝试对用户和客户进行培训，了解这些攻击是如何发生的。

# 攻击过程

我们已经介绍了对目标发起社会工程攻击所需的一些基本步骤。这不是唯一的方法，甚至不是最有可能成功的方法，但它应该让你了解社会工程需要什么。情报收集、识别脆弱点、计划攻击和执行是社会工程师成功泄露和获取目标信息或访问的常见步骤：

*   **情报收集**：有很多技术可以确定渗透测试中最具吸引力的目标。这可以通过使用高级搜索引擎工具在网络上收集公司电子邮件地址来实现；通过在线社交网络收集目标组织员工的个人信息；识别目标组织使用的第三方软件包；参与公司的商业活动和聚会，参加会议，这些都应该提供足够的情报，为社会工程目的选择最准确的内幕人士。
*   **识别弱点**：一旦选择了关键的内部人士，就可以继续建立信任关系并表现友好。这将确保劫持任何公司机密信息的企图不会伤害或提醒目标。在整个过程中保持高度的隐蔽性和隐蔽性非常重要。或者，我们还可以调查目标组织是否使用较旧版本的软件，这些软件可以通过电子邮件或网络发送恶意内容加以利用，从而感染受信任方的计算机。
*   **计划攻击**：计划直接攻击目标还是使用电子辅助方法被动攻击目标，由您选择。基于已识别的易受攻击的入口点，我们可以轻松确定攻击的路径和方法。例如，我们找到了一位友好的客户服务代表 Bob，他会在没有高级管理层事先授权的情况下，无意中执行其电子邮件中的任何恶意文件。
*   **执行**：在最后一步中，我们的计划攻击应以信心和耐心执行，以监控和评估目标攻击的结果。在这一点上，社会工程师应该掌握足够的信息或访问目标公司的财产，这将使他们能够进一步渗透公司资产。成功执行后，开发和获取过程即告完成。

# 攻击方法

有六种方法有助于理解、识别、社交和为最终操作准备目标。这些方法根据其在社会工程领域的独特代表性进行了分类和描述。我们还提供了一些示例来展示一个真实的场景，在这个场景中，您可以应用每个选定的方法。记住，心理因素是这些攻击方法的基础；为了使这些方法更有效，社会工程师应该定期对它们进行演练和练习。

# 模仿

攻击者将假装是其他人以获得信任。例如，为了获取目标的银行信息，网络钓鱼将是完美的解决方案，除非目标没有电子邮件帐户。因此，攻击者首先从目标收集或获取电子邮件地址，然后准备一个外观和功能与原始银行 web 界面完全相同的诈骗页面。

完成所有必要任务后，攻击者准备并发送一封正式电子邮件（例如，帐户详细信息），该电子邮件似乎来自原始银行的网站，要求目标访问链接，以便向攻击者提供最新的银行信息。通过掌握 web 技术的定性技能并使用一套高级工具（例如，SSLstrip），社会工程师可以轻松有效地自动化此任务。关于人工辅助诈骗，我们可以通过实际出现和模拟目标的银行家身份来实现这一点。

# 回报

交换帮助以获得共同利益的行为称为互惠。这种类型的社会工程参与可能涉及临时和长期的业务关系。通过利用业务实体之间的信任，某人可以轻松地映射其目标以获取任何必要的信息。例如，Bob 是一名专业黑客，他想了解 ABC 公司办公楼的物理安全政策。经过仔细研究，他决定开发一个网站，通过廉价出售古董引起了两名员工的浓厚兴趣。

我们假设 Bob 已经知道他们的个人信息，包括通过社交网络、互联网论坛等发送的电子邮件地址。在两名员工中，Alice 开始定期购买物品，成为 Bob 的主要目标。鲍勃现在可以提供一件特殊的古董，以交换他所需要的信息。利用人类心理因素，他给爱丽丝写了一封电子邮件，要求她获得 ABC 公司的物理安全政策细节，她将有权获得一件独特的古董。在没有注意到业务责任的情况下，她向鲍勃透露了这些信息。这证明，在通过交易价值加强关系的同时，创造一个虚假的情境，对社会工程是有利的。

# 权贵

操纵目标的业务职责的攻击方法称为**有影响力的权威攻击**。这种社会工程攻击有时是模拟方法的一部分。人类天生以自动化的方式接受权威或高级管理层的指示，即使他们的直觉表明某些指示不应该执行。这使我们容易受到某些威胁。例如，如果有人想以 XYZ 公司的网络管理员为目标，以获取其身份验证详细信息，则他们会通过交互方式观察并记录管理员和公司 CEO 的电话号码。现在，使用呼叫欺骗服务（例如，[www.spoofcard.com](http://www.spoofcard.com)）给网络管理员打电话，他们会注意到呼叫来自 CEO，应该优先处理。该方法影响目标向模拟机构透露信息；因此，目标公司必须遵守公司高级管理层的指示。

# 稀缺

抓住最好的机会，尤其是在机会似乎很少的情况下，是我们最贪婪的本能之一。这种方法描述了一种为人们提供获取个人利益的机会的方法。著名的**尼日利亚 419 骗局**（[www.419eater.com](http://www.419eater.com)就是人类贪婪的典型例子。让我们举一个例子，Bob 想从 XYZ 大学的学生那里收集个人信息。我们假设他已经拥有所有学生的电子邮件地址。之后，他开发了一封电子邮件，向所有 XYZ 大学的学生提供 iPod 折扣优惠券，然后他们可以回复他们的个人信息（姓名、地址、电话、电子邮件、出生日期、护照号码等）。

由于这一机会是针对学生精心设计的，通过让他们相信自己可以免费获得最新的 iPod，他们中的许多人可能会落入这一骗局。在企业界，这种攻击方法可以扩展到最大化商业收益和实现商业目标。

# 社会关系

我们需要某种形式的社会关系来分享我们的想法、感受和想法。任何社会关系中最脆弱的部分是性。在许多情况下，男人和女人互相吸引和吸引。由于这种强烈的感觉和虚假的信任感，我们最终可能会无意中泄露信息。有几个在线社交门户，人们可以在那里见面和聊天。其中包括 Facebook、MySpace、Twitter 和 Orkut。例如，XYZ 公司聘请 Bob 来获取 ABC 公司的财务和营销战略，以实现可持续的竞争优势。他仔细检查了一些员工，发现一个叫爱丽丝的女孩负责所有的业务运作。他假装是一名普通的商科毕业生，试图找到与她建立关系的途径（例如，通过 Facebook）。Bob 故意创造一些可能遇到 Alice 的场景，比如社交聚会，包括周年纪念、舞蹈俱乐部和音乐节。一旦他获得了一定程度的信任，他可以安排定期与爱丽丝会面。这种做法使他能够从 ABC 公司的财务和营销角度中获得有用的见解。记住，你建立的关系越有效、越信任，你就越能在社会上设计你的目标。有一些工具可以让您更轻松地完成这项任务，例如 SET，我们将在下一节中介绍。

# 好奇心

俗话说：好奇心害死猫。这是对人类的警告，有时我们自己的好奇心会战胜我们。在工作中，好奇心在起作用。我们想知道首席执行官的薪水是多少，谁将被提升，谁将被解雇。因此，社会工程师利用这种天生的好奇心来对付我们。我们可能会被诱惑点击电子邮件中的一个链接，它会给我们一个关于名人八卦的笑话。我们也可能被引诱打开一个实际上是恶意软件的文档，这反过来又会危害我们的系统。渗透测试人员可以通过许多不同的攻击来利用这种好奇心。

# 社会工程工具包

**社会工程工具包**（**套装**）是 TrustedSec（[创始人创建的一套先进、多功能、易用的计算机辅助社会工程工具集 https://www.trustedsec.com/](https://www.trustedsec.com/) ）。它可以帮助您准备最有效的方法来利用客户端应用程序漏洞，并尝试捕获目标的机密信息（例如，电子邮件密码）。SET 采用的一些最有效和有用的攻击方法包括带有恶意文件附件的目标钓鱼电子邮件、Java 小程序攻击、基于浏览器的攻击、收集网站凭据、创建有感染力的便携式媒体（USB/DVD/CD）、群发邮件攻击和其他类似的多重攻击网络载体。这种攻击方法的组合为您提供了一个强大的平台，可以利用和选择最有说服力的技术，对人类元素执行高级攻击。

要启动 SET，请导航到应用程序|开发工具|社会工程工具包。您还可以使用终端加载`SET`：

```
    root@kali:~# setoolkit
```

这将执行设置并显示以下选项：

![](Images/4159841b-6273-400b-8d4a-eacd627c244e.png)

在我们的测试练习中，我们将利用目标的好奇心在目标系统上打开一个反向外壳。为了实现这一点，我们将使用`SET`制作一个可执行文件，并将其放在 USB 设备上。然后，我们将把这个 USB 设备留在组织中的某个地方，看看是否有人拿起它并将其插入。

不要在 Kali Linux 中使用软件包的更新功能。相反，应经常更新 Kali，以便将最新支持的更新应用于您的应用程序。

# 匿名 USB 攻击

在这次攻击中，我们将创建一个可执行文件，它将在目标机器和我们的测试机器之间打开一个反向连接。为了交付这个可执行文件，我们将把它放在一个 USB 设备上，其名称将激起目标的好奇心。配置完 USB 后，将其放在目标组织的公共区域应该会产生我们需要的结果。

欲了解更多信息，请访问[的 SET 部分 http://www.social-engineer.org/framework/general-discussion/.](http://www.social-engineer.org/framework/general-discussion/.)

执行 USB 攻击的步骤如下：

1.  从主选项列表中，我们选择`1) Social Engineering Attacks`：

![](Images/2022ff5a-4fec-4bdf-8b53-d2508051051d.png)

2.  要设计我们将要使用的可执行文件，请选择`3) Infectious Media Generator`：

![](Images/10b699cf-8bd4-455e-8b17-b2d34c815c71.png)

3.  传染性介质生成器将提示要使用的攻击类型。出于我们的目的，我们将使用 Metasploit 可执行文件。选择`2) Standard Metasploit Executable`：

![](Images/5c6e6929-6de1-405e-ac14-08d9648cbac3.png)

4.  有许多不同的有效载荷可供使用。例如，Windows MeterMeter 反向 HTTPS 有效负载在企业环境中非常有用，因为企业通常允许到公共互联网的全面 HTTPS 连接。出于我们的目的，我们将使用一个简单的反向 TCP 连接。输入反向 TCP 外壳的有效负载，在本例中为`2) Windows reverse TCP Meterpreter`：

![](Images/06bafa62-8186-408b-9ed6-333caf809b74.png)

5.  我们需要设置有效负载侦听器，在本例中，它是我们测试机器的 IP 地址（`172.16.122.185`。在某些情况下，您可以使用 Kali Linux 的中央服务器，并使用多个 USB 执行此攻击，所有 USB 都返回有效负载侦听器地址。将反向侦听器端口设置为`4444`，然后按*键进入*。系统将提示您创建侦听器。如果您正在测试，请输入`yes`，这将启动 MeterMeter 侦听器：

![](Images/69deecbc-ba30-4452-b6b7-8e253b7f8d9d.png)

6.  导航到`/root/.set`，您将看到列出的可执行文件：

![](Images/48b540d4-5e6b-4e48-a97d-2d656407ce22.png)

7.  只需将`payload.exe`文件复制到桌面，然后就可以将其加载到 USB 设备上。另一个技巧是将可执行文件的名称更改为可以利用目标好奇心的名称，例如**高管奖金**。如果在 USB 端口上禁用了自动运行功能，这将非常方便。现在，您已经加载了 USB，将其放置在目标企业内的公共区域，甚至停车场。
8.  毫无戒备的受害者拿起 USB 设备并将其插入。此时，可执行文件运行，我们看到 MeterMeter 外壳在测试机器上打开：

![](Images/086ad9b4-225d-4469-9065-9fe40cf51ca3.png)

仅当此攻击是您参与规则的一部分且您的客户了解您将要做的事情时，才使用此攻击。此攻击还需要访问物理位置。您可以通过电子邮件或其他消息服务发送有效负载文件。

布景由创作者不断更新，因此随时都可能发生剧烈的变化。我们只触及了该工具功能的表面。强烈建议您通过访问[继续了解这个强大的社会工程工具集 https://www.trustedsec.com/downloads/social-engineer-toolkit/](https://www.trustedsec.com/downloads/social-engineer-toolkit/) ；从观看该网站上的视频开始。

# 凭证获取

在这次攻击中，我们将建立一个已知网站的假网站。但是，我们的副本将允许我们捕获用户使用的凭据。要让用户访问我们的网站，您需要通过带有标题或主题行的电子邮件发送该网站，以激发用户访问该网站的兴趣。系统将提示他们登录，即会捕获凭据：

1.  进入`setoolkit`，然后在主菜单中选择`1`选项进入社会工程菜单。
2.  在提示下输入`2`选择`Website Attack Vectors`：

![](Images/a5d562ac-b934-4bfd-aa3a-42fb086061c7.png)

3.  为`Credential Harvester`输入`3`：

![](Images/2a7583c8-b956-4c9a-874f-36fdd00a72ad.png)

此时，您已经成功加载了`Credential Harvester Module`。在本模块中，我们有`3`选项：我们可以使用`Web Templates`、`Site Cloner`或`Custom Import`。对于我们的场景，我们使用`2) Site Cloner`选项：

![](Images/607b6c9b-0819-44d8-a120-60e543b13eb1.png)

我们需要提供的第一个参数是网站的主机 IP 地址，这是您当前所在主机的地址。您可以通过在另一个终端中输入`ifconfig`来确认您的 IP，但是模块应该在提示中自动填充它：

![](Images/3951dcff-2e22-4587-9502-3411edb2c83c.png)

目前，我的 IP 是`172.20.1.85`。您的 IP 地址将不同。输入后，下一步是输入要克隆的网站。在这里，我输入，[https://www.facebook.com](https://www.facebook.com) ：

![](Images/32c515e5-734f-412e-857c-158e0df1b35a.png)

克隆站点需要一些时间，但一旦完成，就会收到一条消息，要求您了解 web 服务器的目录结构。在 Kali 上，默认结构是`/var/www/`。点击*进入*，网络服务器将启动。

我在`KALI`中对我的浏览器进行了一次测试，确认它可以正常工作，进入`127.0.0.1`和我的网络 IP`172.20.1.85`，并确认它已加载，如下所示：

![](Images/a5c5fdee-7f52-4717-8e8b-856b7b4b5bfe.png)

从截图中可以看出，`SET`报告了我运行的两个测试，以确认该站点是可访问的。

在这一点上，我们已经成功地建立了我们的参与平台，从这里我们将生成一封带有链接的假电子邮件，该链接指向我们的系统并将其发送到我们的目标。之前进行的侦察的结果将是您的主要来源，电子邮件应该看起来像是从谁那里发送的，应该从谁那里接收，并且电子邮件的措辞需要与他们的书写方式类似，包括签名。

许多经理通过手机回复电子邮件，通常手机上的签名与笔记本电脑上的签名有很大不同。例如，经理的典型签名可能包含他的全名约翰·温特，而当他用手机回复时，他可能会使用`--J`。这是你应该注意的。

我们可以将我们所属网络上的所有用户作为目标，而不是通过电子邮件将目标锁定为少数用户。这将涉及更多的步骤和一些额外的工具。我们将在[第 11 章](11.html)、*无线渗透测试*中回到这一点。

# 恶意 Java 小程序

在这次攻击中，我们将使用与凭据获取攻击类似的设置，这次在页面中嵌入一个自定义 Java 小程序，提示用户执行权限。一旦用户接受提示，将执行有效负载并连接回我们的机器，允许远程访问：

1.  再次启动社会工程师工具包，输入`1`表示`Social Engineering Menu`，然后输入`2`表示`Website Attack Vectors`。
2.  在菜单中，为`Java Applet Attack Method`输入`1`：

![](Images/c860a871-df6b-472a-a85b-b681e7300256.png)

3.  加载后，我们将使用前面示例中的 site cloner 选项：

![](Images/6c3fb1ea-e55b-4712-95ff-fe29a89670e4.png)

4.  系统会询问您是使用端口转发还是启用 NAT。对于本例，我将输入`no`，因为这是在内部环境中设置的。
5.  设置侦听器 IP 地址。默认情况下，`SET`将检测您的 IP 并自动为您填充。只需按*进入*。
6.  系统将提示您使用三个选项之一设置 Java 小程序本身。为此，我们将使用 SET 附带的内置选项。如果您知道如何使用 Java 编写代码，请使用选项`three`输入您自己的自定义代码：

![](Images/1cb16c2f-a2e5-4a72-88de-730fd8e266b0.png)

7.  `SET`将继续生成小程序。系统将提示您输入要克隆的目标站点。您需要选择一个站点，受害者在该站点上接受我们运行 Java 小程序的请求时会有较少的犹豫。在这种情况下，我选择了[https://www.chase.com](https://www.chase.com) 。一旦克隆，`SET`还将自动注入 Java 小程序：

![](Images/93dccb8f-0612-4aa9-bee9-409d34594804.png)

8.  将有效负载注入小程序。对于本例，我们将使用选项`three`：

![](Images/48667168-c1a1-4f25-b579-77f57db67911.png)

9.  最后一个要设置的选项是侦听端口，我将其保留为默认值，`443`：

![](Images/b7be282b-7c1c-43cb-b23e-99a21f240314.png)

安装现在已完成。与凭证收割机类似，我们可以通过电子邮件将链接转发给受害者，确保电子邮件中的措辞不会引起受害者的怀疑，而是让他们认为需要单击链接。

# 总结

在这一章中，我们讨论了社会工程在生活各个方面的普遍应用。渗透测试人员可能会遇到这样的情况：他们必须应用社会工程策略从目标获取敏感信息。人类的天性是容易受到特定欺骗手段的伤害。为了更好地了解社会工程技能，我们提出了一组基本要素（沟通、环境、知识和框架控制），这些要素构成了一个人类心理学模型。反过来，这些心理学原则有助于社会工程师根据被测目标调整和提取攻击过程（情报收集、识别弱点、计划攻击和执行）和方法（模仿、互惠、有影响力的权威、稀缺性和社会关系）。然后，我们解释了如何使用 SET 来启动和自动化互联网上的社会工程攻击。

在下一章中，我们将讨论使用多种工具和技术开发目标的过程，显著地执行漏洞研究并巧妙地获取目标。