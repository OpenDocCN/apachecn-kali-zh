# 十六、最佳做法

首先，我个人要对完成这本书表示祝贺！您已经在网络安全方面获得了一些惊人的技能，特别是在渗透测试领域，使用了最流行的渗透测试 Linux 发行版之一：Kali Linux。在本书的学习过程中，我们非常关注成为渗透测试人员/道德黑客的技术细节和实践方面。

然而，仍然有渗透测试的最佳实践有待涵盖。学习最佳实践将有助于你提高自己，成为商界的专业人士。通过遵循推荐的程序，您将能够有效地工作并以高效的方式获得最佳结果。

在本章中，我们将介绍以下主题：

*   渗透测试仪指南
*   Web 应用程序安全蓝图和检查表
*   网站和网络清单

# 技术要求

本章没有正式的技术要求。

# 渗透测试仪指南

拥有黑客的技能，你必须意识到道德活动和犯罪活动之间的界限。请记住，使用计算机系统执行任何侵入性操作以对他人或组织造成伤害都是非法的。因此，渗透测试人员必须遵守行为准则，以确保他们始终站在法律的正确一边。

在本节剩余部分中，我们将介绍以下要点：

*   获得书面许可
*   合乎道德
*   渗透测试合同
*   **约定规则**（**RoE**
*   附加提示和技巧

现在让我们详细了解一下这些主题。

# 获得书面许可

在目标组织上执行渗透测试之前，请确保您已获得该组织的**书面许可**。如果需要其他机构的额外许可，请确保您获得所有合法许可文件。拥有合法的书面许可就像拥有一张作为渗透测试者的免出狱卡。渗透测试人员执行的任务包括模拟对目标组织的真实网络攻击；这意味着实际上要用任何可能的手段侵入他们的网络。一些攻击可能非常具有侵入性，并可能导致损坏或网络中断；书面许可用于合法保护自己。

# 合乎道德

**作为行业内的专业人士，在你的所有行为中始终保持道德**。在您练习渗透测试技能的过程中，我相信您会意识到，作为一名恶意黑客和渗透测试人员之间存在着细微的差别。主要区别在于渗透测试人员在执行任何类型的攻击之前获得法律许可，目的是帮助组织改善其安全态势，减少实际黑客可能利用的攻击面。讲道德仅仅意味着做正确的事情和坚持道德原则。

# 渗透测试合同

作为一名即将进入行业的专业人士，请确保您拥有一份由律师审核和核实的正确书面的**渗透测试合同**，包括**保密协议**和**保密协议**（**NDAs**）。这是为了确保客户（目标组织）的信息受到保护，并且除非法律要求，否则您（渗透测试人员）不会披露有关客户的任何信息。此外，NDA 在客户和渗透测试人员之间建立信任，因为许多组织不希望其他人知道他们的漏洞。

如果在与新客户的业务会议期间，他们询问您之前进行的渗透测试和客户信息，请不要披露任何细节。这将违反保密协议，该协议保护您的客户和您自己，并建立信任。但是，您可以简单地向新的潜在客户概述您可以为他们的组织做什么，可以执行的测试类型，以及在测试阶段可能使用的一些工具。

# 交战规则

在与客户（目标组织）的业务会议期间，确保您和客户在实际渗透测试之前都了解 RoE。RoE 只是一个由服务提供商（渗透测试人员）创建的文档，概述了要进行的渗透测试的类型以及一些其他细节。其中包括要测试的网络区域，以及网络上的目标，如服务器、网络设备和工作站。简言之，RoE 定义了渗透测试的方式，并指出了与目标组织相关的任何边界。

确保在发生紧急情况时，您已获得目标组织内人员的关键联系信息。作为渗透测试人员，可能会出现危机，您可能需要联系他人寻求帮助，例如，如果您在建筑物内工作时间后进行测试。

在渗透测试期间，如果您发现目标组织系统或网络上存在任何侵犯人权或非法活动，请立即停止并向地方当局（警方）报告。如果您发现网络基础设施中存在安全漏洞，请停止并向组织内的权威人士和/或地方当局报告。作为渗透测试者，你需要有良好的道德和守法；人权和安全始终是第一位的，所有非法活动都要向必要的当局报告。

# 附加提示和技巧

在目标组织的网络上运行任何渗透测试工具之前，请始终在实验室环境中对其进行测试，以确定它们是否使用大量网络带宽，以及它们所产生的噪音级别。如果一个工具占用大量带宽，那么在网络速度较慢的目标组织上使用该工具是没有意义的。该工具可能消耗网段上的所有带宽，导致网络阻塞点；这很糟糕。

使用漏洞扫描程序帮助执行和自动化定期网络扫描。漏洞扫描程序可以帮助组织满足法规遵从性和标准化要求。诸如**Nessus**（[www.tenable.com](http://www.tenable.com)）和**Nexpose**（[www.rapid7.com](http://www.rapid7.com)等工具都是网络安全行业内知名的漏洞扫描工具和管理工具。

此外，了解不同的操作系统，如 Windows、Linux 和 macOS。添加一些网络安全主题作为学习的一部分。了解网络安全和企业网络将帮助您更容易地映射目标网络和绕过网络安全设备。

在下一节中，我们将了解 web 应用程序安全蓝图和检查表。

# Web 应用程序安全蓝图和检查表

在系统或网络上执行渗透测试时，使用一套经批准或推荐的指南，以确保达到预期结果。渗透测试方法通常包括以下阶段：

1.  信息收集
2.  扫描和侦察
3.  指纹和计数
4.  脆弱性评估
5.  开发研究与验证
6.  报告

遵循此类检查表可确保渗透测试人员在进入下一阶段之前完成某一阶段的所有任务。在这本书中，我们从信息收集阶段开始，并逐步从那里开始。前几章介绍了早期阶段，并教您如何获取有关目标的敏感细节，而后几章介绍了如何使用找到的信息使用各种方法访问目标。

在下一节中，我们将了解**开放式 Web 应用程序安全项目（OWASP）前 10 名**。

# OWASP

OWASP 是一个非营利性的基础，它致力于使人们和社区能够开发、测试和维护可以被所有人信任的应用程序。

OWASP 创建了**OWASP 前 10**web 漏洞列表，该列表已成为 web 应用程序测试的标准：

*   A1:2017–注射
*   A2:2017–断开的身份验证
*   A3:2017–敏感数据暴露
*   A4:2017–XML 外部实体（XXE）
*   A5:2017–访问控制中断
*   A6:2017–安全配置错误
*   A7:2017–跨站点脚本（XSS）
*   A8:2017–不安全的反序列化
*   A9:2017–使用具有已知漏洞的组件
*   A10:2017–记录和监控不足

每个类别都提供了所有漏洞的详细分类、发现方法和技术、对策以及降低风险的最佳实践。

有关**OWASP 十大项目**的更多信息，请访问[https://www.owasp.org/index.php/Category:OWASP_Top_Ten_2017_Project](https://www.owasp.org/index.php/Category:OWASP_Top_Ten_2017_Project) 。此外，可在[找到**OWASP 测试指南**https://www.owasp.org/index.php/OWASP_Testing_Project](https://www.owasp.org/index.php/OWASP_Testing_Project) 。

此外，在理解 OWASP 前 10 名方面，始终坚持练习以提高您的技能。OWASP**破网应用程序**（**BWA**项目将帮助您完成旅程。

在下一节中，我们将了解**渗透测试执行标准**（**PTES**的各个阶段）。

# 渗透测试执行标准

PTE 包括几个阶段，涵盖渗透测试的各个方面：

1.  参与前互动
2.  情报收集
3.  威胁建模
4.  脆弱性分析
5.  剥削
6.  实施漏洞利用
7.  报告

有关 PTE 的更多信息，请参见[http://www.penteststandard.org/index.php/Main_Page](http://www.penteststandard.org/index.php/Main_Page) [。](http://www.penteststandard.org/index.php/Main_Page)

渗透测试标准或框架的选择取决于客户要求的测试类型、目标行业（如健康行业的 HIPAA）甚至贵组织的渗透测试方法。

在下一节中，我们将讨论报告阶段的重要性。

# 报告

渗透测试的最后阶段是报告和交付结果。在此阶段，渗透测试人员将创建一份官方文件，概述以下内容：

*   在目标上发现的所有漏洞
*   所有风险，根据**通用脆弱性评分系统**（**CVSS**计算器）按照高、中、低三个等级进行分类
*   针对发现的漏洞的建议补救方法

确保在编写报告时，阅读报告的任何人都能理解，包括高级管理层和执行人员等非技术受众。管理人员并不总是技术性的，因为他们更注重确保在组织内实现业务目标。

报告还应包括以下内容：

*   封面
*   执行摘要
*   漏洞概述
*   测试细节
*   测试期间使用的工具（可选）
*   原工作范围
*   报告正文
*   总结

有关渗透测试报告编写的更多信息，请参见[https://resources.infosecinstitute.com/writing-penetration-testing-reports/](https://resources.infosecinstitute.com/writing-penetration-testing-reports/) 。

永远记住，如果你问 10 个不同的渗透测试人员如何编写报告，他们都会根据自己的经验和雇主给出不同的答案。确保不要插入太多的图像或太多的技术术语，以免混淆读者。对于任何具有非技术背景的人来说，它应该是简单易懂的。

在以下各节中，我们将概述创建渗透测试检查表的基本原理。

# 渗透测试检查表

我建议渗透测试机的以下硬件要求：

*   四核处理器
*   8 GB 内存（最小值）
*   无线网络适配器
*   以太网网络接口卡

接下来，我们将了解如何创建信息收集清单。

# 信息收集

以下是在**信息收集**阶段之前和期间要执行的任务：

1.  获得法律许可。
2.  定义渗透测试的范围。
3.  使用搜索引擎进行信息收集。
4.  执行谷歌黑客技术。
5.  使用社交网站进行信息收集。
6.  执行网站示意图。
7.  执行`WHOIS`信息收集。
8.  执行 DNS 信息收集。
9.  执行网络信息收集。
10.  执行社会工程。

在下一节中，我们将查看网络扫描清单。

# 网络扫描

以下是执行**网络扫描**的指南列表：

1.  在网络上执行主机发现。
2.  执行端口扫描以确定服务。
3.  对目标操作系统和端口执行横幅抓取。
4.  执行漏洞扫描。
5.  创建目标网络的网络拓扑。

接下来，我们将了解枚举检查表的基本要求。

# 列举

以下是在目标系统上执行枚举的指南列表：

1.  确定网络范围并计算子网掩码。
2.  执行主机发现。
3.  执行端口扫描。

4.  执行 SMB 和 NetBIOS 枚举技术。
5.  执行 LDAP 枚举。
6.  执行 DNS 枚举。

在下一节中，我们将看一看利用清单。

# 获取访问权限

以下是**访问**网络/系统的指南列表：

1.  执行社会工程。
2.  进行肩部冲浪。
3.  执行各种密码攻击。
4.  执行网络嗅探。
5.  执行**中间人**（**MITM**攻击。
6.  使用各种技术利用目标系统并获得 shell（即通过命令行获得访问权限）。
7.  发现使用横向移动的其他设备。
8.  尝试升级受损系统上的权限。

在下一节中，我们将概述覆盖轨迹检查表的基本原理。

# 覆盖轨道

以下是**覆盖轨道**的指南列表：

1.  禁用系统上的审核功能。
2.  清除日志文件。

完成本节后，您现在具备了创建适合您需要的完整渗透测试清单所需的技能。

# 总结

通过完成本章，您现在对渗透测试领域的最佳实践有了基本的了解。本章后面部分列出的指南将帮助您确定渗透测试期间应采取的步骤。记住：你在学习——发展你自己的策略和技巧是很自然的。确保在职业发展过程中记录自己的技术和技能。

我希望这一章和这本书对你们的研究有帮助和有用，并将在网络安全的道路上对你们有所帮助。谢谢你的支持！

# 问题

1.  渗透测试前需要什么来确保渗透测试仪受到保护？
2.  什么类型的文档用于概述作业？
3.  如何确定漏洞的风险等级？
4.  渗透测试的最后阶段是什么？

# 进一步阅读

*   净资产收益率：[https://hub.packtpub.com/penetration-testing-rules-of-engagement/](https://hub.packtpub.com/penetration-testing-rules-of-engagement/) 。
*   渗透测试方法：[https://resources.infosecinstitute.com/penetration-testing-methodologies-and-standards/.](https://resources.infosecinstitute.com/penetration-testing-methodologies-and-standards/)
*   其他渗透测试方法见[https://www.owasp.org/index.php/Penetration_testing_methodologies.](https://www.owasp.org/index.php/Penetration_testing_methodologies)

*   以下是一些网站，可帮助您确定网络安全领域的风险严重性和研究威胁：

    *   CVE:[https://cve.mitre.org/](https://cve.mitre.org/)
    *   CVSS:[https://www.first.org/cvss/](https://www.first.org/cvss/)
    *   OWASP:[https://www.owasp.org](https://www.owasp.org)
    *   SANS:[https://www.sans.org/](https://www.sans.org/)
    *   漏洞数据库：[https://www.exploit-db.com/](https://www.exploit-db.com/)
    *   安全焦点：[https://www.securityfocus.com/](https://www.securityfocus.com/)
*   最后，一定要继续学习更多的知识，提高你的技能。以下是将为渗透测试人员增加价值的认证列表：

    *   **攻击性安全认证专业人员**（**OSCP**）：[www.aurprise-Security.com](http://www.offensive-security.com)
    *   **认证道德黑客****CEH**：[www.eccouncil.org](http://www.eccouncil.org)
    *   **GIAC 认证**：[www.GIAC.org](http://www.giac.org)